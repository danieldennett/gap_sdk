<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>GAP8 Manual</title>
<title>GAP8 Manual</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="pulp.css" rel="stylesheet" type="text/css" />
<link href="gap.css" rel="stylesheet" type="text/css" />
<link href="images.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="titlerow">
  <td id="projectlogo"><img alt="Logo" src="gap-logo-55.png" /></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">GAP8 Software Development Kit</div>
    </td>
  <td id="extralogo"><img alt="GreenWaves" src="greenwaves-logo-55.png" /></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="CMSISnav" class="tabs1">
    <ul class="tablist">
      <script type="text/javascript">
		<!--
		writeComponentTabs.call(this);
		//-->
      </script>
	  </ul>
</div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">GAP8 Manual </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="section0"></a>
Introduction of the GAP8 IoT application processor</h1>
<p>GAP8 is a RISC-V and PULP (Parallel Ultra-Low-Power Processing Platform) open-source platform based IoT application processor. It enables cost-effective development, deployment and autonomous operation of intelligent devices that capture, analyze, classify and act on the fusion of rich data sources such as images, sounds or vibrations. In particular, GAP8 is uniquely optimized to execute a large spectrum of image and audio algorithms including convolutional neural network inference with extreme energy efficiency. This allows industrial and consumer product manufacturers to integrate artificial intelligence and advanced classification into new classes of wireless edge devices for IoT applications including image recognition, counting people and objects, machine health monitoring, home security, speech recognition, consumer robotics and smart toys.</p>
<h2><a class="anchor" id="section1"></a>
GAP8 Micro-architecture</h2>
<p>GAP8's hierarchical, demand-driven architecture enables ultra-low-power operation by combining:</p>
<ul>
<li>A series of highly autonomous smart I/O peripherals for connection to cameras, microphones and other capture and control devices.</li>
<li>A fabric controller core for control, communications and security functions.</li>
<li>A cluster of 8 cores with an architecture optimized for the execution of vectorized and parallelized algorithms combined with a specialized Convolutional Neutral Network accelerator (HWCE).</li>
</ul>
<p>All cores and peripherals are power switchable and voltage and frequency adjustable on demand. DC/DC regulators and clock generators with ultra fast reconfiguration times are integrated. This allows GAP8 to adapt extremely quickly to the processing/energy requirements of a running application. All elements share access to a L2 memory area. The cluster cores and HWCE share access to a L1 memory area and instruction cache. Multiple DMA units allow autonomous, fast, low power transfers between memory areas. A memory protection unit is included to allow secured execution of applications on GAP8.</p>
<p>All 9 cores share the same extended RISC-V instruction set architecture. The I (integer), C (compressed instruction), M (Multiplication and division) extensions and a portion of the supervisor ISA subsets are supported. These are extended with specific instructions to optimize the algorithms that GAP8 is targeted at. These extensions include zero overhead hardware loops, pointer post/pre modified memory accesses, instructions mixing control flow with computation (min, max, etc), multiply/subtract and accumulate, vector operations, fixed point operations, bit manipulation and dot product. All of these instruction extensions are optimized by the compiler or can be used 'by hand'.</p>
<h2><a class="anchor" id="section2"></a>
GAP8 Features</h2>
<ul>
<li>1+8 high performance extended RISC-V ISA based cores.<ul>
<li>1 - A high performance micro-controller</li>
<li>8 - 8 cores that execute in parallel for compute intensive tasks</li>
</ul>
</li>
<li>A hardware Convolution Engine (HWCE) for Convolutional Neural Networks based applications.</li>
<li>A level 2 Memory (512KB) for all the cores</li>
<li>A level 1 Memory (64 KB) shared by all the cores in Cluster</li>
<li>A level 1 memory (8 KB) owned by FC</li>
<li>A smart, lightweight and completely autonomous DMA (micro-DMA) capable of handling complex I/O schemes.</li>
<li>A multi-channel 1D/2D cluster-DMA controls the transactions between the L2 Memory and L1 Memory.</li>
<li>A rich set of peripheral interface</li>
<li>2 programmable clocks</li>
<li>Memory Protection Unit</li>
</ul>
<div class="image">
<img src="GAP8Layout.png" alt="GAP8Layout.png"/>
<div class="caption">
GAP8 Layout</div></div>
<p> As shown in the GAP8 block diagram above, GAP8 has a rich set of I/O interfaces, which includes:</p>
<table class="doxtable">
<tr>
<th>Interface </th><th>Number </th><th>Description  </th></tr>
<tr>
<td>LVDS </td><td>1 </td><td>A 128 Mb/s interface for RF </td></tr>
<tr>
<td>ORCA </td><td>1 </td><td>A low debit interface for RF. </td></tr>
<tr>
<td>I2C </td><td>2 </td><td>Standard I2C interfaces. </td></tr>
<tr>
<td>I2S </td><td>2 </td><td>Standard I2S interface for connecting digital audio devices. </td></tr>
<tr>
<td>CPI </td><td>1 </td><td>A parallel interface for connecting camera </td></tr>
<tr>
<td>HyperBus </td><td>1 </td><td>A high speed memory bus interface </td></tr>
<tr>
<td>SPI-M </td><td>2 </td><td>A quad SPI-M and an additional SPI-M </td></tr>
<tr>
<td>SPI-S </td><td>1 </td><td>A SPI Slave </td></tr>
<tr>
<td>UART </td><td>1 </td><td>A standard UART interface </td></tr>
<tr>
<td>GPIOs </td><td>32</td><td>General Purpose Input Output </td></tr>
</table>
<p>Other peripherals:</p>
<table class="doxtable">
<tr>
<th>Peripherals </th><th align="center">Number </th><th>Description  </th></tr>
<tr>
<td>RTC </td><td align="center">1 </td><td>32K real-time clock </td></tr>
<tr>
<td>PWM </td><td align="center">4 </td><td>PWMs, 12 Output channels </td></tr>
</table>
<h2><a class="anchor" id="section3"></a>
The Fabric Controller and The Cluster</h2>
<p>As mentioned in previous section, GAP8 has 8+1 high performance cores, which play two different roles. The cluster contains 8 cores that can execute in parallel, and provide high performance calculation for image processing, audio processing or signal modulation, etc. The single core, referred to as the “Fabric Controller” or "FC", is used as micro-controller. It is in charge of controlling all the operations of GAP8, like the micro-DMA to capture 1 image from the CPI interface, starting up the cluster and dispatching a job to it, etc. You can think of the cluster as a 'peripheral' of the FC.</p>
<p>Cores are identified using two identification numbers. The cluster ID which identifies the group of cores that the core belongs to and the core ID which identifies the core in that group. The IDs can be used to start a particular task on a core.</p>
<table class="doxtable">
<tr>
<th>ENTITY </th><th align="center">CLUSTER ID </th><th align="center">CORE ID  </th></tr>
<tr>
<td>CORE0 </td><td align="center">0x00 </td><td align="center">0x00 </td></tr>
<tr>
<td>CORE1 </td><td align="center">0x00 </td><td align="center">0x01 </td></tr>
<tr>
<td>CORE2 </td><td align="center">0x00 </td><td align="center">0x02 </td></tr>
<tr>
<td>CORE3 </td><td align="center">0x00 </td><td align="center">0x03 </td></tr>
<tr>
<td>CORE4 </td><td align="center">0x00 </td><td align="center">0x04 </td></tr>
<tr>
<td>CORE5 </td><td align="center">0x00 </td><td align="center">0x05 </td></tr>
<tr>
<td>CORE6 </td><td align="center">0x00 </td><td align="center">0x06 </td></tr>
<tr>
<td>CORE7 </td><td align="center">0x00 </td><td align="center">0x07 </td></tr>
<tr>
<td>FC </td><td align="center">0x20 </td><td align="center">0x00 </td></tr>
</table>
<p>The table above shows:</p>
<ul>
<li>Core 0-7: which have the same cluster ID, but have different core ID.</li>
<li>FC: which has the same core ID as the cluster core 0, but its cluster ID is equal to 0x20.</li>
</ul>
<p>By default, the cluster is powered down and cannot be used. It must first be powered-up by the FC. Once the cluster is awake, its core 0 plays the role of "master". Core 0 is in charge of the following jobs:</p>
<ul>
<li>The communication with the Fabric Controller. For example, getting a task from the FC, sending a data request to the FC, getting synchronized with the FC, etc.</li>
<li>Dispatching tasks/applications to other cores.</li>
</ul>
<p>Before receiving a task from the core 0, the rest of the cores stay at a dispatch barrier which clock gates them (i.e. they are stopped and use only a low leakage current).</p>
<p>When a task/application is finished on the cluster, it should be shut down to save power. IT IS IMPORTANT TO MOVE DATA IN THE SHARED L1 MEMORY TO THE L2 MEMORY BEFORE YOU SHUTDOWN THE CLUSTER.</p>
<h2><a class="anchor" id="section4"></a>
Memory areas</h2>
<p>There are 2 different levels of memory internal to GAP8. A larger level 2 area of 512KB which is accessible by all processors and DMA units and two smaller level 1 areas, one for the FC (16KB) and one shared by all the cluster cores (64KB). The shared level 1 memory is banked and cluster cores can usually access their bank in a single cycle. GAP8 can also access external memory areas over the HyperBus (Flash or RAM) or quad-SPI (Flash) peripherals. We refer to RAM accessed over the HyperBus interface as level 3 memory. Since the energy cost and performance cost of accessing external RAM over the HyperBus is very high compared to the internal memory generally this should be avoided as much as possible. Code is generally located in the L2 memory area. The instruction caches of the FC (4KB) and cluster (16KB) will automatically cache instructions as needed. The cluster instruction cache is shared between all the cores in the cluster. Generally the cluster cores will be executing the same area of code on different data so the shared cluster instruction cache exploits this to reduce memory accesses for loading instructions.</p>
<h2><a class="anchor" id="section5"></a>
Micro-DMA and cluster-DMA</h2>
<p>To reduce power consumption GAP8 does not include data caches in its memory hierarchy. Instead GAP8 uses autonomous DMA units that can be used to transfer data to and from peripherals and in between internal memory areas.</p>
<p>Good management of memory is absolutely crucial to extracting the most energy efficiency from GAP8. GreenWaves supplies a tool, the GAP8 auto-tiler, which can significantly aid in managing memory transfers between the different memory areas.</p>
<p>The micro-DMA unit is used to transfer data to and from peripherals including level 3 memory. At the end of a transaction the FC can be woken up to queue a new task. To allow the micro-DMA to continue working at the end of a transaction up to 2 transfers can be queued for each peripheral. The micro-DMA schedules active transfers based on signals from the peripherals in a round-robin fashion. Generally the micro-DMA is not used directly by a programmer. It is used by the drivers for each of the peripherals.</p>
<p>As the micro-DMA, the cluster-DMA is a smart, lightweight and completely autonomous unit. It is used to transfer data between the L2 and L1 memory areas. It supports both 1D and 2D transfers and can queue up to 16 requests. The commands for the cluster-DMA unit are extremely short which minimizes SW overhead and avoids instruction cache pollution. </p>
<h1><a class="anchor" id="section6"></a>
Introduction to the GAP SDK</h1>
<p>The GAP8 SDK allows you to compile and execute applications on the GAP8 IoT Application Processor. This SDK is an extract of the necessary elements from the pulp-sdk (<a href="https://github.com/pulp-platform/pulp-sdk">https://github.com/pulp-platform/pulp-sdk</a>) produced by the PULP project, to provide a development environment for the GAP8 series processors.</p>
<p>We provide you with all the necessary tools and two different operating systems for GAP8:</p>
<ul>
<li>Tools<ul>
<li>GAP8 RISCV GNU toolchain: a pre-compiled toolchain inherited from RISC V project with support for our extensions to the RISC-V Instruction Set Architecture.</li>
<li>PLPBRIDGE: a tool from the PULP project which allows communication between your PC and a GAP8 processor. Using this tool you can:<ul>
<li>Program / control GAP8</li>
<li>Debug your application using GDB</li>
<li>Program the GAPuino flash memory with applications</li>
</ul>
</li>
</ul>
</li>
<li>Operating Systems<ul>
<li>PULP OS - The open source embedded RTOS produced by the PULP project</li>
<li>Arm® Mbed™ OS - Arm Mbed OS is an open source embedded operating system. GreenWaves Technologies has ported it to GAP8 and VEGA.</li>
<li>FreeRTOS - FreeRTOS is an open source real time operating system. GreenWaves Technologies has ported it to GAP8</li>
<li>PMSIS - PMSIS is an open-source system layer which any operating system can implement to provide a common API to applications. We currently provide it fro PULP OS and FreeRTOS, and it is used by our applications to be portable.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="section7"></a>
Installing the GAP SDK</h1>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Feb 12 2020 11:11:29 for  by GreenWaves Technologies
	<!--
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 
	-->
	</li>
  </ul>
</div>
</body>
</html>
